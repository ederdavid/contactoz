<script type="text/javascript">
jQuery(document).ready(function($){
             var names = [];
             <%
             @names
	     @company = Company.find(:all,:conditions => ['company_name LIKE ?', "#{params[:query]}%"],  :limit => 20)
	     for company in @company 
		 @names = company.company_name %>
	         names.push("<%="#{@names}"%>");
	     <%end
	     %>
	$(function(){
	  var a = $('#query').autocomplete({ 
	    serviceUrl:'service/autocomplete.ashx',
	    minChars:2, 
	    delimiter: /(,|;)\s*/, // regex or character
	    maxHeight:400,
	    width:300,
	    zIndex: 9999,
	    deferRequestBy: 0, //miliseconds
	    params: { country:'Yes' }, //aditional parameters
	    noCache: false, //default is false, set to true to disable caching
	    // local autosugest options:
	    lookup: names,//['January', 'February', 'March', 'April', 'May'] //local lookup values 
	    suggestions: names
	  });

	});
});
</script>

<% @query = params[:search] %>

<div class="search">

<form id="search_form">
<div class="wrap">
<input id = "query" type="text" data-default="search" value="" name="search"></input>
<button type="submit"></button>
</div>
</form>

</div>
<div class="clear"></div>

<!-- \search -->


<% if @companies %>

<%= render :partial => "shared/companyresults", :object => @companies %>

<!-- \results -->

<% else %>


<%= render :partial => 'shared/homepage' %>

<% end %>
